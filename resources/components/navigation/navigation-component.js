class SiteNavigation extends HTMLElement {
    constructor() {
        super();
        this.render();
    }
    
    static get observedAttributes() {
        return ['current-page'];
    }
    
    attributeChangedCallback(name, oldValue, newValue) {
        if (oldValue !== newValue) {
            this.render();
        }
    }
    
    get currentPage() {
        return this.getAttribute('current-page') || this.detectCurrentPage();
    }
    
    // Nouvelle méthode : récupérer le titre de la page courante
    getCurrentPageTitle() {
        const titles = {
            home: 'Home',
            banking: 'Banking delivery services',
            about: 'About us'
        };
        
        return titles[this.currentPage] || 'About us';
    }
    
    detectCurrentPage() {
        const path = window.location.pathname;
        const filename = path.split('/').pop().split('.')[0];
        
        const pageMap = {
            'index': 'home',
            'about': 'about',
            'banking-services': 'banking'
        };
        
        return pageMap[filename] || 'home';
    }
    
    getMenuItems() {
        const menus = {
            home: [
                { href: 'about.html', text: 'About us' },
                { href: 'banking-services.html', text: 'Banking delivery services' }
            ],
            banking: [
                { href: 'index.html', text: 'Home' },
                { href: 'about.html', text: 'About us' }
            ],
            about: [
                { href: 'index.html', text: 'Home' },
                { href: 'banking-services.html', text: 'Banking delivery services' }
            ]
        };
        
        return menus[this.currentPage] || menus.home;
    }
    
    render() {
        const menuItems = this.getMenuItems();
        const currentPageTitle = this.getCurrentPageTitle(); // Utiliser la nouvelle méthode
        
        this.innerHTML = `
        <header>
            <div class="header-container">
                <div class="hero-logo">
                    <a href="index.html">
                        <svg width="152" height="33" viewBox="0 0 152 33" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M35.9277 11.5091V6.18972C35.9277 2.88082 33.2471 0.200195 29.9382 0.200195H6.1476C2.8387 0.200195 0.199951 2.88082 0.199951 6.14784V26.2107C0.199951 29.5196 2.88058 32.2002 6.18948 32.2002H29.9382C33.2471 32.2002 35.9696 29.5196 35.9696 26.1688V20.8494H30.0219V26.1688H6.1476V6.14784H30.0219V11.4672L35.9277 11.5091Z" fill="#EF3340"/>
                            <path d="M44.891 32.2002H50.8386V10.2944H44.891V32.2002Z" fill="#EF3340"/>
                            <path d="M44.8491 0.200195H38.9015V10.2944H44.8491V0.200195Z" fill="#EF3340"/>
                            <path d="M75.7183 25.3732C75.0062 26.2109 74.0429 26.6297 72.8282 26.6297H69.6869C68.4303 26.6297 67.4251 26.2109 66.6712 25.415C65.9172 24.6192 65.4984 23.5302 65.4984 22.1899V16.7449C65.4984 15.2789 65.8754 14.148 66.6293 13.2266C67.3832 12.347 68.3884 11.8862 69.645 11.8862H72.7863C73.9591 11.8862 74.8806 12.2213 75.5926 12.8496C76.3047 13.4779 76.6398 14.3574 76.6398 15.3627H79.3204C79.3204 13.6035 78.734 12.1376 77.5193 11.0485C76.3466 9.95954 74.7549 9.41504 72.7863 9.41504H69.645C67.5926 9.41504 65.9172 10.0852 64.6607 11.4255C63.4042 12.7658 62.7759 14.525 62.7759 16.703V22.148C62.7759 24.2423 63.4042 25.9177 64.6607 27.1742C65.9172 28.4307 67.5926 29.059 69.6869 29.059H72.8282C74.7968 29.059 76.3884 28.4307 77.645 27.1323C78.8596 25.8339 79.4879 24.1166 79.4879 22.0224H76.7654C76.8073 23.4046 76.3884 24.5355 75.7183 25.3732Z" fill="#201D1B"/>
                            <path d="M100.221 9.8335C96.3257 9.8335 92.6817 11.5508 92.556 15.9487H95.2367C95.3623 13.0167 97.8754 12.2209 100.221 12.2209C102.943 12.2209 104.535 13.0586 104.535 15.4042V16.8701L98.5456 18.0848C94.3152 18.9225 91.844 20.556 91.844 23.823C91.844 27.2157 94.3152 29.2262 98.4199 29.2262C100.724 29.2262 102.985 28.4304 104.577 26.2105V28.8073H107.048V15.1948C107.09 11.9277 104.912 9.8335 100.221 9.8335ZM104.493 21.3099C104.493 25.1633 101.519 26.8387 98.5456 26.8387C95.8231 26.8387 94.6503 25.5403 94.6503 23.7393C94.6503 21.5612 96.2838 20.933 98.9225 20.3466L104.493 19.1738V21.3099Z" fill="#201D1B"/>
                            <path d="M124.933 4.59791H122.252V10.2942H113.833V7.69739C113.833 6.23142 114.378 5.51938 115.844 5.51938H118.902V3.17383H115.383C112.158 3.17383 111.153 4.6398 111.153 7.4042V10.2942H107.718V12.6398H111.153V28.7655H113.833V12.6398H122.252V24.5351C122.252 27.2995 123.258 28.7655 126.483 28.7655H130.001V26.4199H126.943C125.436 26.4199 124.933 25.7079 124.933 24.2419V12.6398H130.001V10.2942H124.933V4.59791Z" fill="#201D1B"/>
                            <path d="M139.635 10.2944H136.912V28.7656H139.635V10.2944Z" fill="#201D1B"/>
                            <path d="M139.635 4.59814H136.912V7.94893H139.635V4.59814Z" fill="#201D1B"/>                                <path d="M151.697 12.64V10.2945H146.629V4.59814H143.949V10.2945H140.514V12.64H143.949V24.5353C143.949 27.2997 144.954 28.7657 148.179 28.7657H151.697V26.4201H148.64C147.132 26.4201 146.629 25.7081 146.629 24.2421V12.64H151.697Z" fill="#201D1B"/>
                            <path d="M80.912 14.5247V28.7655H83.5926V14.776C83.5926 13.31 84.1371 12.598 85.6031 12.598H91.1738V10.2524H85.1424C81.8753 10.2943 80.912 11.7184 80.912 14.5247Z" fill="#201D1B"/>
                        </svg>
                    </a>
                </div>
                <div class="baseline">
                    Crafting resilience</br>
                    with precision
                </div>
                <div class="menu">
                    <div class="menu-container">
                        <div class="menu-item-selected">
                            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="currentColor"><path d="M240-190.77q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm240 0q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm240 0q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm-480-240q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm240 0q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm240 0q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm-480-240q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm240 0q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Zm240 0q-20.31 0-34.77-14.46-14.46-14.46-14.46-34.77 0-20.31 14.46-34.77 14.46-14.46 34.77-14.46 20.31 0 34.77 14.46 14.46 14.46 14.46 34.77 0 20.31-14.46 34.77-14.46 14.46-34.77 14.46Z"/></svg>
                            <span class="toggle-menu">${currentPageTitle}</span>
                        </div>
                        ${menuItems.map((item, index) => `
                            <div class="menu-items m-item-${index + 1}">
                                <a href="${item.href}">${item.text}</a>
                            </div>
                        `).join('')}
                    </div>
                </div>
            </div>
        </header>
        `;
    }
}

export { SiteNavigation };